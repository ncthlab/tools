// 顯示檔案內容
async function showFileContent(fileName) {
    const fileExtension = fileName.split('.').pop().toLowerCase();
    const contentElement = document.getElementById('file-content');
    contentElement.innerHTML = ''; // 清空現有的檔案內容

    const filePath = `${fileUrl}${currentPath ? currentPath + '/' : ''}${fileName}`;

    // 判斷檔案副檔名並顯示對應內容
    if (fileExtension === 'pdf' || fileExtension === 'ppt' || fileExtension === 'pptx' || fileExtension === 'doc' || fileExtension === 'docx') {
        // 使用 Google Docs Viewer 顯示 PDF、PPT、Word 檔案
        const iframe = document.createElement('iframe');
        iframe.src = `https://docs.google.com/viewer?url=${encodeURIComponent(filePath)}&embedded=true`;
        contentElement.appendChild(iframe);
    } else if (fileExtension === 'txt' || fileExtension === 'md') {
        // 顯示純文本檔案
        try {
            const response = await fetch(filePath);
            if (response.ok) {
                const content = await response.text();
                contentElement.textContent = content;  // 顯示檔案內容
            } else {
                contentElement.innerHTML = '無法顯示此檔案內容。';
            }
        } catch (error) {
            console.error("無法顯示檔案內容：", error);
            contentElement.innerHTML = '無法顯示檔案內容。';
        }
    } else {
        // 顯示其他無法預覽的格式提示
        contentElement.innerHTML = '此格式無法預覽。';
    }
}
